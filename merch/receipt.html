<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ABECON2025 | Checkout</title>
    <link rel="icon" href="logo.png">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <!-- <link rel="stylesheet" href="style.css"> -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindplus/elements@1" type="module"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.2.1/flowbite.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Montserrat', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        @layer utilities {
            .receipt-mask {
                --mask: conic-gradient(from -45deg at bottom, #0000, #000 1deg 89deg, #0000 90deg) 50%/30px 100%;
                -webkit-mask: var(--mask);
                mask: var(--mask);
            }
        }
    </style>

</head>

<body class="h-screen bg-[url('/images/background.jpg')] bg-cover bg-no-repeat font-sans">

    <nav
        class="bg-white dark:bg-gray-900 fixed w-full z-20 top-0 start-0 border-b border-gray-200 dark:border-gray-600">
        <div class="max-w-screen-xl mx-auto p-4 flex justify-center items-center">
            <a href="#" class="flex items-center space-x-3">
                <img src="merchlogo.png" class="h-10" alt="Logo">

            </a>
        </div>
    </nav>



    <main class="w-full max-w-md mx-auto  p-6 md:p-8 mt-32 relative">

        <!-- Receipt Background Vector (like the subtract layer) -->
        <div class="absolute inset-0 bg-[url('/images/receipt-bg.svg')] bg-cover bg-no-repeat opacity-10 rounded-lg">
        </div>

        <!-- Receipt Card -->
        <div class="relative bg-white shadow-lg rounded-xl p-6 space-y-6 text-center">

            <!-- Icon -->
            <div class="flex justify-center">
                <span id="status-icon" class="material-icons material-symbols-outlined text-5xl p-3"></span>
            </div>

            <!-- Title -->
            <h2 id="status-title" class="text-xl font-bold"></h2>




            <p id="status-desc" class="text-sm text-gray-600"></p>
            <!-- Divider -->
            <hr>

            <!-- Order Details -->
            <div class="text-left space-y-2 text-sm">
                <div class="flex justify-between">
                    <span class="font-medium">Order ID:</span>
                    <span class="flex items-center gap-1">
                        <span id="order-id"></span>
                        <span class="material-symbols-outlined text-gray-500 text-sm cursor-pointer"
                            data-copy="#order-id">content_copy</span>
                    </span>
                </div>



                <div class="flex justify-between">
                    <span class="font-medium">Date and Time:</span>
                    <span id="order-date" class="text-right"></span>
                </div>
                <div class="flex justify-between">
                    <span class="font-medium">Order Status:</span>
                    <span id="order-status" class="text-yellow-600 font-semibold first-letter:uppercase"></span>
                </div>
            </div>

            <!-- Divider -->
            <hr>

            <!-- Payment Info -->
            <div class="text-left space-y-2 text-sm">


                <!-- Payment Ref No -->
                <div class="flex justify-between">
                    <span class="font-medium">Payment Ref No.:</span>
                    <span id="payment-refno" class="text-right"></span>
                </div>

                <!-- Total amount -->
                <div class="flex justify-between">
                    <span class="font-medium">Total amount:</span>
                    <span id="total-amount" class="font-semibold text-right"></span>
                </div>
            </div>



            <!-- Button -->
            <div class="pt-4">
                <a href="merchandise.html"
                    class="w-full inline-flex items-center justify-center gap-2 bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-4 rounded-lg shadow">
                    <span class="material-symbols-outlined text-base">arrow_left_alt</span>
                    Back to Merch
                </a>
            </div>

        </div>



    </main>


    <script>
        function showToast(message) {
            const container = document.getElementById("toast-container");
            const toast = document.createElement("div");

            toast.className = "bg-white text-gray-800 font-medium text-sm px-6 py-3 rounded-lg shadow-lg transition-opacity duration-500 opacity-0";
            toast.innerText = message;

            container.appendChild(toast);

            // Fade in
            setTimeout(() => toast.classList.remove("opacity-0"), 50);

            // Fade out after 2s
            setTimeout(() => {
                toast.classList.add("opacity-0");
                setTimeout(() => toast.remove(), 500);
            }, 2000);
        }

        document.querySelectorAll("[data-copy]").forEach(el => {
            el.addEventListener("click", () => {
                const target = el.getAttribute("data-copy");
                const text = document.querySelector(target).innerText.trim();
                navigator.clipboard.writeText(text).then(() => {
                    showToast("Copied Order ID: " + text);
                });
            });
        });
    </script>



    <!-- Toast container -->
    <div id="toast-container" class="fixed bottom-5 left-1/2 -translate-x-1/2 z-50 space-y-2"></div>

    <script>
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

    </script>



<script>
    document.addEventListener("DOMContentLoaded", () => {
  const orderId = getQueryParam("orderid");
  if (!orderId) {
    showToast("No order ID provided in URL.");
    return;
  }

  fetch("getorderreceipt.php?orderid=" + encodeURIComponent(orderId))
    .then(res => res.json())
    .then(data => {
      if (!data.success) {
        showToast("Error: " + data.message);
        return;
      }

      const order = data.order;

      // Basic info
            document.getElementById("order-id").innerText = order.order_id;
            document.querySelector("#order-id + .material-symbols-outlined")
                .setAttribute("data-copy", "#order-id");
            document.querySelector("#order-date").innerText = order.placed_at;
            document.querySelector("#payment-refno").innerText = order.payment_refno;
            document.getElementById("total-amount").innerText =
                "â‚±" + parseFloat(order.total_amount).toFixed(2);
      const status = order.order_status.toLowerCase();

      // Elements
      const statusIcon = document.getElementById("status-icon");
      const statusTitle = document.getElementById("status-title");
      const statusDesc = document.getElementById("status-desc");
      const statusEl = document.getElementById("order-status");

      // Status config
      const statusMap = {
        "pending": {
          icon: "hourglass_top",
          color: "text-yellow-600",
          title: "Order Submitted",
          desc: "Your order has been placed and is awaiting payment verification."
        },
        "payment under review": {
          icon: "search",
          color: "text-yellow-600",
          title: "Payment Under Review",
          desc: "Your payment is currently under review. Please wait for confirmation."
        },
        "payment verified": {
          icon: "check_circle",
          color: "text-green-600",
          title: "Payment Verified",
          desc: "Your payment has been verified. You can now claim your order."
        },
        "claimable": {
          icon: "shopping_bag",
          color: "text-green-600",
          title: "Ready to Claim",
          desc: "Your order is ready to be claimed. Please follow the instructions sent to your email."
        },
        "completed": {
          icon: "task_alt",
          color: "text-green-600",
          title: "Order Completed",
          desc: "Your order has been completed. Thank you for your purchase!"
        },
        "fraudulent": {
          icon: "report",
          color: "text-red-600",
          title: "Fraudulent Order",
          desc: "This order has been flagged as fraudulent. Please contact support."
        },
        "cancelled": {
          icon: "cancel",
          color: "text-gray-500",
          title: "Order Cancelled",
          desc: "This order has been cancelled."
        },
        "refunded": {
          icon: "payments",
          color: "text-blue-600",
          title: "Refunded",
          desc: "Your order has been refunded. The amount will reflect in your account shortly."
        }
      };

      const config = statusMap[status] || statusMap["pending"];

      // Update UI
      statusIcon.innerText = config.icon;
      statusIcon.className = `material-symbols-outlined text-5xl p-3 ${config.color}`;
      statusTitle.innerText = config.title;
      statusDesc.innerText = config.desc;
      statusEl.innerText = order.order_status;
      statusEl.className = `font-semibold first-letter:uppercase ${config.color}`;
    })
    .catch(err => {
      console.error("Fetch error:", err);
      showToast("Unable to fetch order details.");
    });
});

</script>
</body>

</html>